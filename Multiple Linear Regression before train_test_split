#1 Importing the libraries
import numpy as np 
import pandas as pd
import matplotlib.pyplot as plt
#2 Importing the dataset:
dataset = pd.read_csv("E:/6 sem Notes/ML/Datasets/50_Startups.csv")

X= dataset.iloc[:, :-1].values
Y=dataset.iloc[:, 4].values


from sklearn.preprocessing import LabelEncoder, OneHotEncoder
labelencoder_X = LabelEncoder()


X[: ,3]= labelencoder_X.fit_transform(X[: ,3])
import category_encoders as ce
encoder=ce.OneHotEncoder(cols=['State'])
dataset=encoder.fit_transform(dataset)

dataset.head()

X= dataset.iloc[:, :-1].values
Y=dataset.iloc[:, 6].values

from sklearn.model_selection import train_test_split
X_train, X_test, Y_train, Y_test = train_test_split( X, Y, test_size=0.2, random_state=0)

from sklearn.linear_model import LinearRegression

regressor = LinearRegression()
 
regressor.fit(X_train,Y_train)

y_pred= regressor.predict(X_test)
from sklearn.metrics import r2_score
#print(regressor.score(X_train,Y_train))
print(r2_score(Y_test, y_pred))
